{"version":3,"file":"wx-promise-pro.js","sources":["../src/methods.js","../src/index.js"],"sourcesContent":["export const asyncMethods = [\n  'canvasGetImageData',\n  'canvasPutImageData',\n  'canvasToTempFilePath',\n  'setEnableDebug',\n  'startAccelerometer',\n  'stopAccelerometer',\n  'getBatteryInfo',\n  'getClipboardData',\n  'setClipboardData',\n  'startCompass',\n  'stopCompass',\n  'addPhoneContact',\n  'startGyroscope',\n  'stopGyroscope',\n  'startBeaconDiscovery',\n  'stopBeaconDiscovery',\n  'getBeacons',\n  'startLocalServiceDiscovery',\n  'stopLocalServiceDiscovery',\n  'startDeviceMotionListening',\n  'stopDeviceMotionListening',\n  'getNetworkType',\n  'makePhoneCall',\n  'scanCode',\n  'getSystemInfo',\n  'vibrateShort',\n  'vibrateLong',\n  'getExtConfig',\n  'chooseLocation',\n  'getLocation',\n  'openLocation',\n  'chooseMessageFile',\n  'loadFontFace',\n  'chooseImage',\n  'previewImage',\n  'getImageInfo',\n  'saveImageToPhotosAlbum',\n  'compressImage',\n  'chooseVideo',\n  'saveVideoToPhotosAlbum',\n  'downloadFile',\n  'request',\n  'connectSocket',\n  'closeSocket',\n  'sendSocketMessage',\n  'uploadFile',\n  'login',\n  'checkSession',\n  'chooseAddress',\n  'authorize',\n  'addCard',\n  'openCard',\n  'chooseInvoice',\n  'chooseInvoiceTitle',\n  'getUserInfo',\n  'requestPayment',\n  'getWeRunData',\n  'showModal',\n  'showToast',\n  'hideToast',\n  'showLoading',\n  'hideLoading',\n  'showActionSheet',\n  'pageScrollTo',\n  'startPullDownRefresh',\n  'stopPullDownRefresh',\n  'setBackgroundColor',\n  'setBackgroundTextStyle',\n  'setTabBarBadge',\n  'removeTabBarBadge',\n  'showTabBarRedDot',\n  'hideTabBarRedDot',\n  'showTabBar',\n  'hideTabBar',\n  'setTabBarStyle',\n  'setTabBarItem',\n  'setTopBarText',\n  'saveFile',\n  'openDocument',\n  'getSavedFileList',\n  'getSavedFileInfo',\n  'removeSavedFile',\n  'getFileInfo',\n  'getStorage',\n  'setStorage',\n  'removeStorage',\n  'clearStorage',\n  'getStorageInfo',\n  'closeBLEConnection',\n  'closeBluetoothAdapter',\n  'createBLEConnection',\n  'getBLEDeviceCharacteristics',\n  'getBLEDeviceServices',\n  'getBluetoothAdapterState',\n  'getBluetoothDevices',\n  'getConnectedBluetoothDevices',\n  'notifyBLECharacteristicValueChange',\n  'openBluetoothAdapter',\n  'readBLECharacteristicValue',\n  'startBluetoothDevicesDiscovery',\n  'stopBluetoothDevicesDiscovery',\n  'writeBLECharacteristicValue',\n  'getHCEState',\n  'sendHCEMessage',\n  'startHCE',\n  'stopHCE',\n  'getScreenBrightness',\n  'setKeepScreenOn',\n  'setScreenBrightness',\n  'connectWifi',\n  'getConnectedWifi',\n  'getWifiList',\n  'setWifiList',\n  'startWifi',\n  'stopWifi',\n  'getBackgroundAudioPlayerState',\n  'playBackgroundAudio',\n  'pauseBackgroundAudio',\n  'seekBackgroundAudio',\n  'stopBackgroundAudio',\n  'getAvailableAudioSources',\n  'startRecord',\n  'stopRecord',\n  'setInnerAudioOption',\n  'playVoice',\n  'pauseVoice',\n  'stopVoice',\n  'getSetting',\n  'openSetting',\n  'getShareInfo',\n  'hideShareMenu',\n  'showShareMenu',\n  'updateShareMenu',\n  'checkIsSoterEnrolledInDevice',\n  'checkIsSupportSoterAuthentication',\n  'startSoterAuthentication',\n  'navigateBackMiniProgram',\n  'navigateToMiniProgram',\n  'setNavigationBarTitle',\n  'showNavigationBarLoading',\n  'hideNavigationBarLoading',\n  'setNavigationBarColor',\n  'redirectTo',\n  'reLaunch',\n  'navigateTo',\n  'switchTab',\n  'navigateBack'\n]\n","import { asyncMethods } from './methods'\n\n// polyfill for finally\nif(!Promise.prototype.finally) {\n  Promise.prototype.finally = function (callback) {\n    let P = this.constructor\n    return this.then(\n      value  => P.resolve(callback()).then(() => value),\n      reason => P.resolve(callback()).then(() => { throw reason })\n    )\n  }\n}\n\n// core method\nexport const promisify = (api) => {\n  return (args = {}) => {\n    return new Promise((resolve, reject) => {\n      api({\n        fail: reject,\n        success: resolve,\n        ...args,\n      })\n    })\n  }\n}\n\nexport const promisifyAll = () => {\n  wx.pro = {}\n  Object.keys(wx).forEach(key => {\n    if (asyncMethods.indexOf(key) >= 0) {\n      wx.pro[key] = promisify(wx[key])\n    } else {\n      wx.pro[key] = wx[key]\n    }\n  })\n}\n"],"names":["asyncMethods","Promise","prototype","callback","P","this","constructor","then","value","resolve","reason","promisify","api","args","reject","fail","success","promisifyAll","wx","pro","Object","keys","forEach","key","indexOf"],"mappings":"urBAAO,IAAMA,EAAe,CAC1B,qBACA,qBACA,uBACA,iBACA,qBACA,oBACA,iBACA,mBACA,mBACA,eACA,cACA,kBACA,iBACA,gBACA,uBACA,sBACA,aACA,6BACA,4BACA,6BACA,4BACA,iBACA,gBACA,WACA,gBACA,eACA,cACA,eACA,iBACA,cACA,eACA,oBACA,eACA,cACA,eACA,eACA,yBACA,gBACA,cACA,yBACA,eACA,UACA,gBACA,cACA,oBACA,aACA,QACA,eACA,gBACA,YACA,UACA,WACA,gBACA,qBACA,cACA,iBACA,eACA,YACA,YACA,YACA,cACA,cACA,kBACA,eACA,uBACA,sBACA,qBACA,yBACA,iBACA,oBACA,mBACA,mBACA,aACA,aACA,iBACA,gBACA,gBACA,WACA,eACA,mBACA,mBACA,kBACA,cACA,aACA,aACA,gBACA,eACA,iBACA,qBACA,wBACA,sBACA,8BACA,uBACA,2BACA,sBACA,+BACA,qCACA,uBACA,6BACA,iCACA,gCACA,8BACA,cACA,iBACA,WACA,UACA,sBACA,kBACA,sBACA,cACA,mBACA,cACA,cACA,YACA,WACA,gCACA,sBACA,uBACA,sBACA,sBACA,2BACA,cACA,aACA,sBACA,YACA,aACA,YACA,aACA,cACA,eACA,gBACA,gBACA,kBACA,+BACA,oCACA,2BACA,0BACA,wBACA,wBACA,2BACA,2BACA,wBACA,aACA,WACA,aACA,YACA,gBChJEC,QAAQC,oBACVD,QAAQC,kBAAoB,SAAUC,OAChCC,EAAIC,KAAKC,mBACND,KAAKE,MACV,SAAAC,UAAUJ,EAAEK,QAAQN,KAAYI,MAAK,kBAAMC,QAC3C,SAAAE,UAAUN,EAAEK,QAAQN,KAAYI,MAAK,iBAAcG,cAM5CC,EAAY,SAACC,UACjB,eAACC,yDAAO,UACN,IAAIZ,SAAQ,SAACQ,EAASK,GAC3BF,KACEG,KAAMD,EACNE,QAASP,GACNI,SAMEI,EAAe,WAC1BC,GAAGC,IAAM,GACTC,OAAOC,KAAKH,IAAII,SAAQ,SAAAC,GAClBvB,EAAawB,QAAQD,IAAQ,EAC/BL,GAAGC,IAAII,GAAOZ,EAAUO,GAAGK,IAE3BL,GAAGC,IAAII,GAAOL,GAAGK"}